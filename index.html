<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="google-site-verification" content="7gdXI8hLMyXdI4Yz25h-TwDNg2XYobmbR8GeXGxD75g" />

    <title>Cenas Rápidas y Saludables</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Lora:ital,wght@0,400;1,500&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        html { scroll-behavior: smooth; }
        body { font-family: 'Poppins', sans-serif; }
        h1, h2, h3 { font-family: 'Poppins', sans-serif; font-weight: 700; }
        .recipe-card-title { font-family: 'Lora', serif; font-weight: 500; font-style: italic; }
        .modal-body::-webkit-scrollbar { display: none; }
        .modal-body { -ms-overflow-style: none; scrollbar-width: none; }
        .lang-selector { transition: all 0.3s ease; }
        .lang-option { cursor: pointer; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <!-- SELECTOR DE IDIOMA -->
    <div class="fixed top-4 right-4 z-50">
        <div id="language-selector" class="lang-selector bg-white rounded-full shadow-lg flex items-center p-1">
             <div class="lang-option p-1 rounded-full hover:bg-gray-200" data-lang="es">
                <img src="https://flagcdn.com/es.svg" width="30" alt="Español">
            </div>
            <div class="lang-option p-1 rounded-full hover:bg-gray-200" data-lang="en">
                 <img src="https://flagcdn.com/gb.svg" width="30" alt="English">
            </div>
            <div class="lang-option p-1 rounded-full hover:bg-gray-200" data-lang="ru">
                 <img src="https://flagcdn.com/ru.svg" width="30" alt="Русский">
            </div>
        </div>
    </div>

    <!-- Contenedor Principal -->
    <div class="container mx-auto p-4 md:p-8 max-w-5xl">

        <!-- Encabezado -->
        <header class="bg-gradient-to-r from-emerald-500 to-green-500 text-white p-8 rounded-2xl shadow-lg mb-8 text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-2" data-translate="header_title"></h1>
            <p class="text-lg md:text-xl opacity-90" data-translate="header_subtitle"></p>
        </header>

        <!-- Barra de Navegación -->
        <nav class="bg-white rounded-2xl shadow-md mb-8 sticky top-4 z-10">
            <ul class="flex justify-center items-center p-2 space-x-2 md:space-x-6">
                <li><a href="#inicio" class="nav-link text-gray-600 hover:text-emerald-600 font-semibold py-2 px-3 transition-colors duration-300" data-translate="nav_home"></a></li>
                <li><a href="#recetas" class="nav-link text-gray-600 hover:text-emerald-600 font-semibold py-2 px-3 transition-colors duration-300" data-translate="nav_recipes"></a></li>
                <li><a href="#consejos" class="nav-link text-gray-600 hover:text-emerald-600 font-semibold py-2 px-3 transition-colors duration-300" data-translate="nav_tips"></a></li>
                <li><a href="#" class="text-gray-600 hover:text-emerald-600 font-semibold py-2 px-3 transition-colors duration-300" data-translate="nav_contact"></a></li>
            </ul>
        </nav>

        <!-- Contenido Principal -->
        <main>
            <!-- SECCIÓN DE INICIO -->
            <section id="inicio" class="text-center mb-16 p-8 bg-white rounded-2xl shadow-md">
                <h2 class="text-3xl font-bold text-emerald-600 mb-4" data-translate="welcome_title"></h2>
                <p class="max-w-3xl mx-auto text-gray-600 mb-6" data-translate="welcome_text"></p>
                <a href="#recetas" class="inline-block bg-amber-500 hover:bg-amber-600 text-white font-bold py-3 px-8 rounded-lg transition-transform duration-300 hover:scale-105" data-translate="welcome_button"></a>
            </section>

            <!-- SECCIÓN DE RECETAS -->
            <section id="recetas" class="mb-16">
                <h2 class="text-3xl font-bold text-center text-gray-700 mb-8" data-translate="recipes_title"></h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Tarjetas de Receta se generan con JS -->
                </div>
            </section>
            
            <!-- SECCIÓN DE CONSEJOS -->
            <section id="consejos" class="mb-16 p-8 bg-white rounded-2xl shadow-md">
                <h2 class="text-3xl font-bold text-center text-gray-700 mb-8" data-translate="tips_title"></h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Consejos se generan con JS -->
                </div>
            </section>

            <!-- SECCIÓN NEWSLETTER -->
            <section id="newsletter" class="mb-16 p-8 bg-gradient-to-r from-gray-700 to-gray-800 rounded-2xl shadow-lg text-white text-center">
                <h2 class="text-3xl font-bold mb-4" data-translate="newsletter_title"></h2>
                <p class="max-w-2xl mx-auto opacity-80 mb-6" data-translate="newsletter_text"></p>
                <form id="newsletter-form" class="flex flex-col sm:flex-row justify-center items-center gap-4 max-w-md mx-auto">
                    <input type="email" id="email-input" class="w-full sm:w-auto flex-grow px-4 py-3 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-emerald-400" required>
                    <button type="submit" id="subscribe-button" class="w-full sm:w-auto bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-3 px-6 rounded-lg transition-all duration-300 flex items-center justify-center space-x-2">
                        <span data-translate="newsletter_button"></span>
                    </button>
                </form>
                 <p id="newsletter-feedback" class="mt-4 h-6"></p>
            </section>
        </main>

        <!-- Pie de Página -->
        <footer class="text-center mt-12 py-6 border-t border-gray-200">
            <p class="text-gray-500" data-translate="footer_text"></p>
        </footer>
    </div>

    <!-- MODAL PARA RECETAS -->
    <div id="recipe-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col">
            <div class="p-4 border-b flex justify-between items-center">
                <h3 id="modal-title" class="text-2xl recipe-card-title"></h3>
                <button id="close-modal" class="text-gray-500 hover:text-red-600">
                    <i class="ph-bold ph-x text-2xl"></i>
                </button>
            </div>
            <div class="p-6 modal-body overflow-y-auto">
                <img id="modal-image" src="" alt="Imagen de la receta" class="w-full h-64 object-cover rounded-lg mb-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="text-xl font-bold mb-2 text-emerald-700" data-translate="modal_ingredients"></h4>
                        <ul id="modal-ingredients" class="list-disc list-inside text-gray-600 space-y-1"></ul>
                    </div>
                    <div>
                        <h4 class="text-xl font-bold mb-2 text-emerald-700" data-translate="modal_preparation"></h4>
                        <ol id="modal-steps" class="list-decimal list-inside text-gray-600 space-y-2"></ol>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

    <!-- SCRIPT DE LA APLICACIÓN -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tus llaves de Firebase
            const firebaseConfig = {
                apiKey: "AIzaSyCZNcceO31zkq8gqgLbwlb0ycFvHRY-yFc",
                authDomain: "cenasrapidas-ed192.firebaseapp.com",
                projectId: "cenasrapidas-ed192",
                storageBucket: "cenasrapidas-ed192.firebasestorage.app",
                messagingSenderId: "281525239097",
                appId: "1:281525239097:web:3f74706d926a4271c7fce8"
            };

            // Inicialización de Firebase
            let app, auth, db;
            try {
                app = firebase.initializeApp(firebaseConfig);
                auth = firebase.auth();
                db = firebase.firestore();
                auth.signInAnonymously().catch((error) => {
                    console.error("Error en el inicio de sesión anónimo:", error);
                });
            } catch (error) {
                console.error("Error al inicializar Firebase:", error);
                document.body.innerHTML = '<div style="text-align: center; padding: 50px; font-size: 1.2em;">Error de conexión. La configuración de Firebase es incorrecta.</div>';
                return;
            }

            const content = {
                es: {
                    header_title: "Cenas Rápidas y Saludables", header_subtitle: "Recetas deliciosas en menos de 30 minutos, perfectas para tu estilo de vida.",
                    nav_home: "Inicio", nav_recipes: "Recetas", nav_tips: "Consejos", nav_contact: "Contacto",
                    welcome_title: "¡Bienvenida/o a tu salvación en la cocina!", welcome_text: "Aquí encontrarás un universo de recetas increíblemente fáciles, rápidas y, lo más importante, ¡deliciosas!", welcome_button: "¡Quiero cocinar ya!",
                    recipes_title: "Nuestras Recetas Estrella", tips_title: "Consejos para Ahorrar Tiempo y Comer Mejor",
                    newsletter_title: "¡Únete a nuestra comunidad!", newsletter_text: "Recibe las nuevas recetas y los mejores consejos directamente en tu correo cada semana. ¡Sin spam!", newsletter_button: "Suscribirme", newsletter_placeholder: "Tu correo electrónico",
                    feedback_success: "¡Gracias por suscribirte!", feedback_error: "Email inválido o error. Inténtalo de nuevo.",
                    footer_text: "© 2025 Cenas Rápidas y Saludables | Creado con ❤️ para ti.",
                    modal_ingredients: "Ingredientes", modal_preparation: "Preparación", recipe_button_text: "Ver Receta",
                    recipes: [
                        { title: "Pasta Cremosa con Tomates Cherry", description: "Una cena deliciosa y rápida con ingredientes frescos y un toque italiano.", image: "https://images.pexels.com/photos/1437267/pexels-photo-1437267.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", ingredients: ["200g de pasta", "1 taza de tomates cherry", "2 dientes de ajo", "1/2 taza de crema de leche", "Queso parmesano", "Albahaca fresca", "Aceite de oliva, sal, pimienta"], steps: ["Cocina la pasta.", "Saltea el ajo y los tomates.", "Añade la crema y cocina.", "Mezcla todo con la pasta y sirve."] },
                        { title: "Ensalada de Quinoa y Aguacate", description: "Una opción nutritiva y llena de sabor, ideal para una cena ligera pero completa.", image: "https://images.pexels.com/photos/1211887/pexels-photo-1211887.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", ingredients: ["1 taza de quinoa cocida", "1 aguacate en cubos", "1/2 taza de garbanzos", "1/4 cebolla morada", "Jugo de 1 limón", "Cilantro fresco", "Aceite de oliva, sal, pimienta"], steps: ["Mezcla la quinoa y garbanzos.", "Añade el aguacate y la cebolla.", "Prepara el aderezo de limón y aceite.", "Mezcla todo y sirve."] },
                        { title: "Tostadas con Huevo y Salmón", description: "Una cena elegante y fácil, rica en proteínas y grasas saludables Omega-3.", image: "https://images.pexels.com/photos/566566/pexels-photo-566566.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", ingredients: ["2 rebanadas de pan integral", "2 huevos", "50g de salmón ahumado", "1/4 de aguacate", "Eneldo o cebollino", "Sal y pimienta"], steps: ["Tuesta el pan.", "Prepara los huevos revueltos.", "Unta el aguacate en las tostadas.", "Monta todo: tostada, aguacate, huevo y salmón."] }
                    ],
                    tips: [
                        { icon: "ph-leaf", title: "Mise en place es tu amigo", text: "Antes de empezar, pica todas tus verduras y ten listos los ingredientes. Te ahorrará un estrés increíble." },
                        { icon: "ph-timer", title: "Cocina un poco de más", text: "Si haces arroz o quinoa, cocina el doble. Así ya tienes una base lista para tu almuerzo o cena del día siguiente." },
                        { icon: "ph-heart-straight", title: "Salsas que salvan vidas", text: "Prepara un par de salsas o aderezos sencillos durante el fin de semana. Un buen pesto o vinagreta transforman cualquier plato." },
                        { icon: "ph-sparkle", title: "No le temas a las especias", text: "Un poco de pimentón ahumado, comino o hierbas secas pueden llevar tu plato de 'meh' a '¡wow!' en segundos." }
                    ]
                },
                en: {
                    header_title: "Quick & Healthy Dinners", header_subtitle: "Delicious recipes in under 30 minutes, perfect for your lifestyle.",
                    nav_home: "Home", nav_recipes: "Recipes", nav_tips: "Tips", nav_contact: "Contact",
                    welcome_title: "Welcome to your kitchen salvation!", welcome_text: "Here you'll find a universe of incredibly easy, fast, and most importantly, delicious recipes!", welcome_button: "Let's cook now!",
                    recipes_title: "Our Star Recipes", tips_title: "Tips to Save Time and Eat Better",
                    newsletter_title: "Join our community!", newsletter_text: "Receive new recipes and the best tips directly in your email every week. No spam!", newsletter_button: "Subscribe", newsletter_placeholder: "Your email address",
                    feedback_success: "Thanks for subscribing!", feedback_error: "Invalid email or error. Please try again.",
                    footer_text: "© 2025 Quick & Healthy Dinners | Made with ❤️ for you.",
                    modal_ingredients: "Ingredients", modal_preparation: "Preparation", recipe_button_text: "View Recipe",
                    recipes: [
                        { title: "Creamy Cherry Tomato Pasta", description: "A delicious and quick dinner with fresh ingredients and an Italian touch.", image: "https://images.pexels.com/photos/1437267/pexels-photo-1437267.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", ingredients: ["200g of pasta", "1 cup cherry tomatoes", "2 garlic cloves", "1/2 cup heavy cream", "Parmesan cheese", "Fresh basil", "Olive oil, salt, pepper"], steps: ["Cook the pasta.", "Sauté garlic and tomatoes.", "Add cream and cook.", "Mix everything with the pasta and serve."] },
                        { title: "Quinoa and Avocado Salad", description: "A nutritious and flavorful option, ideal for a light but very complete dinner.", image: "https://images.pexels.com/photos/1211887/pexels-photo-1211887.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", ingredients: ["1 cup cooked quinoa", "1 avocado, diced", "1/2 cup chickpeas", "1/4 red onion", "Juice of 1 lemon", "Fresh cilantro", "Olive oil, salt, pepper"], steps: ["Mix quinoa and chickpeas.", "Add avocado and onion.", "Prepare lemon and oil dressing.", "Mix everything and serve."] },
                        { title: "Toast with Egg and Salmon", description: "An elegant and easy dinner, rich in protein and healthy Omega-3 fats.", image: "https://images.pexels.com/photos/566566/pexels-photo-566566.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", ingredients: ["2 slices of whole wheat bread", "2 eggs", "50g smoked salmon", "1/4 avocado", "Dill or chives", "Salt and pepper"], steps: ["Toast the bread.", "Prepare scrambled eggs.", "Spread avocado on the toast.", "Assemble everything: toast, avocado, egg, and salmon."] }
                    ],
                    tips: [
                        { icon: "ph-leaf", title: "Mise en place is your friend", text: "Before you start, chop all your vegetables and have your ingredients ready. It will save you incredible stress." },
                        { icon: "ph-timer", title: "Cook a little extra", text: "If you're making rice or quinoa, cook double. That way you have a base ready for your next day's lunch or dinner." },
                        { icon: "ph-heart-straight", title: "Life-saving sauces", text: "Prepare a couple of simple sauces or dressings over the weekend. A good pesto or vinaigrette can transform any boring dish." },
                        { icon: "ph-sparkle", title: "Don't be afraid of spices", text: "A little smoked paprika, cumin, or dried herbs can take your dish from 'meh' to 'wow!' in seconds." }
                    ]
                },
                ru: {
                    header_title: "Быстрые и здоровые ужины", header_subtitle: "Вкусные рецепты менее чем за 30 минут, идеально для вашего образа жизни.",
                    nav_home: "Главная", nav_recipes: "Рецепты", nav_tips: "Советы", nav_contact: "Контакт",
                    welcome_title: "Добро пожаловать в ваше кухонное спасение!", welcome_text: "Здесь вы найдете вселенную невероятно простых, быстрых и, самое главное, вкусных рецептов!", welcome_button: "Начнем готовить!",
                    recipes_title: "Наши звездные рецепты", tips_title: "Советы, как сэкономить время и питаться лучше",
                    newsletter_title: "Присоединяйтесь к нашему сообществу!", newsletter_text: "Получайте новые рецепты и лучшие советы прямо на вашу почту каждую неделю. Без спама!", newsletter_button: "Подписаться", newsletter_placeholder: "Ваш e-mail",
                    feedback_success: "Спасибо за подписку!", feedback_error: "Неверный email или ошибка. Попробуйте снова.",
                    footer_text: "© 2025 Быстрые и здоровые ужины | Сделано с ❤️ для вас.",
                    modal_ingredients: "Ингредиенты", modal_preparation: "Приготовление", recipe_button_text: "Смотреть рецепт",
                    recipes: [
                        { title: "Сливочная паста с томатами черри", description: "Вкусный и быстрый ужин со свежими ингредиентами и итальянской ноткой.", image: "https://images.pexels.com/photos/1437267/pexels-photo-1437267.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", ingredients: ["200г пасты", "1 стакан томатов черри", "2 зубчика чеснока", "1/2 стакана сливок", "Сыр пармезан", "Свежий базилик", "Оливковое масло, соль, перец"], steps: ["Сварите пасту.", "Обжарьте чеснок и помидоры.", "Добавьте сливки и готовьте.", "Смешайте все с пастой и подавайте."] },
                        { title: "Салат с киноа и авокадо", description: "Питательный и ароматный вариант, идеально для легкого, но очень сытного ужина.", image: "https://images.pexels.com/photos/1211887/pexels-photo-1211887.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", ingredients: ["1 стакан вареной киноа", "1 авокадо, кубиками", "1/2 стакана нута", "1/4 красного лука", "Сок 1 лимона", "Свежая кинза", "Оливковое масло, соль, перец"], steps: ["Смешайте киноа и нут.", "Добавьте авокадо и лук.", "Приготовьте заправку из лимона и масла.", "Все смешайте и подавайте."] },
                        { title: "Тосты с яйцом и лососем", description: "Элегантный и простой ужин, богатый белком и полезными жирами Омега-3.", image: "https://images.pexels.com/photos/566566/pexels-photo-566566.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", ingredients: ["2 ломтика хлеба", "2 яйца", "50г копченого лосося", "1/4 авокадо", "Укроп или зеленый лук", "Соль и перец"], steps: ["Поджарьте хлеб.", "Приготовьте яичницу.", "Намажьте авокадо на тосты.", "Соберите все: тост, авокадо, яйцо и лосось."] }
                    ],
                    tips: [
                        { icon: "ph-leaf", title: "Mise en place - ваш друг", text: "Прежде чем начать, нарежьте все овощи и подготовьте ингредиенты. Это сэкономит вам невероятное количество стресса." },
                        { icon: "ph-timer", title: "Готовьте немного больше", text: "Если вы готовите рис или киноа, готовьте вдвое больше. Так у вас уже будет готова основа на следующий день." },
                        { icon: "ph-heart-straight", title: "Соусы, спасающие жизнь", text: "Приготовьте пару простых соусов на выходных. Хороший песто или винегрет преобразят любое скучное блюдо." },
                        { icon: "ph-sparkle", title: "Не бойтесь специй", text: "Немного копченой паприки, тмина или сушеных трав могут превратить ваше блюдо из 'так себе' в 'вау!'." }
                    ]
                }
            };

            let currentLang = localStorage.getItem('language') || 'es';

            const langOptions = document.querySelectorAll('.lang-option');
            const modal = document.getElementById('recipe-modal');
            const closeModalButton = document.getElementById('close-modal');
            const newsletterForm = document.getElementById('newsletter-form');
            const emailInput = document.getElementById('email-input');
            const subscribeButton = document.getElementById('subscribe-button');
            const newsletterFeedback = document.getElementById('newsletter-feedback');

            function translatePage() {
                document.documentElement.lang = currentLang;
                document.querySelectorAll('[data-translate]').forEach(el => {
                    const key = el.getAttribute('data-translate');
                    el.textContent = content[currentLang][key] || '';
                });
                emailInput.placeholder = content[currentLang].newsletter_placeholder;

                generateRecipeCards();
                generateTips();
                attachRecipeButtonListeners();

                langOptions.forEach(opt => {
                    opt.classList.toggle('bg-gray-200', opt.dataset.lang === currentLang);
                });
            }

            function generateRecipeCards() {
                const container = document.querySelector('#recetas .grid');
                container.innerHTML = '';
                content[currentLang].recipes.forEach(recipe => {
                    container.innerHTML += `
                        <article class="recipe-card bg-white rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 flex flex-col">
                            <img src="${recipe.image}" alt="${recipe.title}" class="w-full h-56 object-cover">
                            <div class="p-6 flex-grow flex flex-col">
                                <h3 class="text-2xl recipe-card-title text-gray-800 mb-2">${recipe.title}</h3>
                                <p class="text-gray-600 flex-grow mb-4">${recipe.description}</p>
                                <button class="recipe-button mt-auto self-start bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-2 px-5 rounded-lg transition-colors duration-300">${content[currentLang].recipe_button_text}</button>
                            </div>
                        </article>`;
                });
            }

            function generateTips() {
                const container = document.querySelector('#consejos .grid');
                container.innerHTML = '';
                content[currentLang].tips.forEach(tip => {
                    container.innerHTML += `
                        <div class="flex items-start space-x-4">
                            <i class="ph-light ${tip.icon} text-4xl text-emerald-500 bg-emerald-100 p-2 rounded-full"></i>
                            <div>
                                <h4 class="font-bold text-lg">${tip.title}</h4>
                                <p class="text-gray-600">${tip.text}</p>
                            </div>
                        </div>`;
                });
            }
            
            function attachRecipeButtonListeners() {
                document.querySelectorAll('.recipe-button').forEach((button, index) => {
                    button.addEventListener('click', () => {
                        const recipe = content[currentLang].recipes[index];
                        document.getElementById('modal-title').textContent = recipe.title;
                        document.getElementById('modal-image').src = recipe.image;
                        
                        const ingredientsList = document.getElementById('modal-ingredients');
                        ingredientsList.innerHTML = '';
                        recipe.ingredients.forEach(ing => ingredientsList.innerHTML += `<li>${ing}</li>`);

                        const stepsList = document.getElementById('modal-steps');
                        stepsList.innerHTML = '';
                        recipe.steps.forEach(step => stepsList.innerHTML += `<li>${step}</li>`);

                        modal.classList.remove('hidden');
                    });
                });
            }
            
            // --- LÓGICA NEWSLETTER ---
            newsletterForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = emailInput.value.trim();
                const originalButtonText = subscribeButton.querySelector('span').textContent;

                if (!email || !/^\S+@\S+\.\S+$/.test(email)) {
                    newsletterFeedback.textContent = content[currentLang].feedback_error;
                    newsletterFeedback.classList.add('text-red-400');
                    setTimeout(() => {
                        newsletterFeedback.textContent = '';
                        newsletterFeedback.classList.remove('text-red-400');
                    }, 3000);
                    return;
                }

                subscribeButton.disabled = true;
                subscribeButton.innerHTML = `<i class="ph ph-circle-notch animate-spin text-2xl"></i>`;

                db.collection(`/artifacts/${firebaseConfig.projectId}/public/data/subscribers`).add({
                    email: email,
                    subscribedAt: firebase.firestore.FieldValue.serverTimestamp(),
                    language: currentLang
                })
                .then(() => {
                    subscribeButton.innerHTML = `<i class="ph ph-check text-2xl"></i>`;
                    newsletterFeedback.textContent = content[currentLang].feedback_success;
                    newsletterFeedback.classList.add('text-green-400');
                    emailInput.value = '';
                })
                .catch((error) => {
                    console.error("Error adding document: ", error);
                    subscribeButton.innerHTML = `<i class="ph ph-x text-2xl"></i>`;
                    newsletterFeedback.textContent = content[currentLang].feedback_error;
                    newsletterFeedback.classList.add('text-red-400');
                })
                .finally(() => {
                    setTimeout(() => {
                        subscribeButton.disabled = false;
                        subscribeButton.innerHTML = `<span>${originalButtonText}</span>`;
                        newsletterFeedback.textContent = '';
                        newsletterFeedback.classList.remove('text-green-400', 'text-red-400');
                    }, 3000);
                });
            });


            // --- INICIALIZACIÓN ---
            langOptions.forEach(option => option.addEventListener('click', () => {
                currentLang = option.dataset.lang;
                localStorage.setItem('language', currentLang);
                translatePage();
            }));
            
            closeModalButton.addEventListener('click', () => modal.classList.add('hidden'));
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.classList.add('hidden');
            });

            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('main section');
            function updateActiveLink() {
                let currentSectionId = '';
                sections.forEach(section => {
                    if (pageYOffset >= section.offsetTop - 100) {
                        currentSectionId = section.getAttribute('id');
                    }
                });
                navLinks.forEach(link => {
                    link.classList.remove('bg-emerald-100', 'text-emerald-700');
                    if (link.getAttribute('href') === `#${currentSectionId}`) {
                        link.classList.add('bg-emerald-100', 'text-emerald-700');
                    }
                });
            }
            window.addEventListener('scroll', updateActiveLink);

            translatePage();
        });
    </script>
</body>
</html>
